digraph G {
    graph [rankdir=LR, overlap=false, repulsiveforce=1, dpi = 200, splines=true]
    edge [color="grey25"]

    // New node
    "Counts" [pos="1,1.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];

    // Define Nodes with Positions
    "Outlier Removal and\n Data Preprocessing" [pos="2,1.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    "total_raw_counts()\nis_outlier()" [pos="2,.9!", shape=box, color="lightblue", fontcolor="black", style=filled];
    
    "Incoming Neutron\nFlux Correction" [pos="3,1.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    "cutoff_rigidity()\nfind_neutron_monitor()\nget_incoming_neutron_flux()\ninterpolate_incoming_flux()\ncorrection_incoming_flux()" [pos="3,.9!", shape=box, color="lightblue", fontcolor="black", style=filled];

    "Atmospheric\nCorrection" [pos="4,1.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    "correction_humidity()\ncorrection_pressure()" [pos="4,1!", shape=box, color="lightblue", fontcolor="black", style=filled];
    
    "Biomass\nCorrection" [pos="1,.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    "biomass_to_bwe()\ncorrection_bwe()" [pos="1,0!", shape=box, color="lightblue", fontcolor="black", style=filled];

    "Soil Mositure\nEstimation" [pos="2,.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    "smooth_1d()\nlattice_water()\ncounts_to_vwc()" [pos="2,0!", shape=box, color="lightblue", fontcolor="black", style=filled];

    "Soil VWC" [pos="3,.5!", shape=box3d, color="midnightblue", fontcolor="white", style=filled, group=1];
    
    // Define Edges
    "Outlier Removal and\n Data Preprocessing" -> "total_raw_counts()\nis_outlier()"
    "Incoming Neutron\nFlux Correction" -> "cutoff_rigidity()\nfind_neutron_monitor()\nget_incoming_neutron_flux()\ninterpolate_incoming_flux()\ncorrection_incoming_flux()"
    "Atmospheric\nCorrection" -> "correction_humidity()\ncorrection_pressure()"
    "Biomass\nCorrection" -> "biomass_to_bwe()\ncorrection_bwe()"
    "Soil Mositure\nEstimation" -> "smooth_1d()\nlattice_water()\ncounts_to_vwc()"
    
    // Steps Arrows
    "Counts" -> "Outlier Removal and\n Data Preprocessing"
    "Outlier Removal and\n Data Preprocessing" -> "Incoming Neutron\nFlux Correction"
    "Incoming Neutron\nFlux Correction" -> "Atmospheric\nCorrection"
    "Atmospheric\nCorrection" -> "Biomass\nCorrection"
    "Biomass\nCorrection" -> "Soil Mositure\nEstimation" [style=dashed]
    "Soil Mositure\nEstimation" -> "Soil VWC"
}
