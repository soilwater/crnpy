
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CRNPy is a Python package for the estimation and processing of soil moisture data from cosmic-ray neutron counts.">
      
      
      
        <link rel="canonical" href="https://soilwater.github.io/crnpy/correction_routines/">
      
      
        <link rel="prev" href="../sensor_description/">
      
      
        <link rel="next" href="../examples/stationary/example_RDT_station/">
      
      
      <link rel="icon" href="../img/logo/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>Correction routines - CRNPy Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Correction routines - CRNPy Documentation" >
      
        <meta  property="og:description"  content="CRNPy is a Python package for the estimation and processing of soil moisture data from cosmic-ray neutron counts." >
      
        <meta  property="og:image"  content="https://soilwater.github.io/crnpy/assets/images/social/correction_routines.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://soilwater.github.io/crnpy/correction_routines/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Correction routines - CRNPy Documentation" >
      
        <meta  name="twitter:description"  content="CRNPy is a Python package for the estimation and processing of soil moisture data from cosmic-ray neutron counts." >
      
        <meta  name="twitter:image"  content="https://soilwater.github.io/crnpy/assets/images/social/correction_routines.png" >
      
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CRNPy Documentation" class="md-header__button md-logo" aria-label="CRNPy Documentation" data-md-component="logo">
      
  <img src="../img/logo/crnpy-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CRNPy Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Correction routines
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/soilwater/crnpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CRNPy Documentation" class="md-nav__button md-logo" aria-label="CRNPy Documentation" data-md-component="logo">
      
  <img src="../img/logo/crnpy-logo.svg" alt="logo">

    </a>
    CRNPy Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/soilwater/crnpy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../sensor_description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sensor description
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Correction routines
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Correction routines
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stationary-crnp-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary CRNP processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roving-crnp-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Roving CRNP processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incoming-neutron-flux" class="md-nav__link">
    <span class="md-ellipsis">
      Incoming neutron flux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atmospheric-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Atmospheric corrections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#biomass-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Biomass correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#road-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Road correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Additional corrections
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/stationary/example_RDT_station/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processing and analyzing data from a stationary detector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/rover/Hydroinnova_rover_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processing and analyzing data from a roving detector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/calibration/calibration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Device-specific field calibration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stationary-crnp-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary CRNP processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roving-crnp-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Roving CRNP processing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#incoming-neutron-flux" class="md-nav__link">
    <span class="md-ellipsis">
      Incoming neutron flux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atmospheric-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Atmospheric corrections
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#biomass-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Biomass correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#road-correction" class="md-nav__link">
    <span class="md-ellipsis">
      Road correction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-corrections" class="md-nav__link">
    <span class="md-ellipsis">
      Additional corrections
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  

  
  


  <h1>Correction routines</h1>

<h3 id="overview">Overview</h3>
<p>The CRNPy library provides the tools to correct and process neutron counts recorded with both stationary and roving cosmic-ray neutron probes. Below are two flowcharts describing the typical steps from the correction of raw neutron counts to the conversion into volumetric soil water content.</p>
<h4 id="stationary-crnp-processing">Stationary CRNP processing</h4>
<p><a class="glightbox" href="../img/workflow_rdt.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="CRNPy Processing Workflow" src="../img/workflow_rdt.png" /></a>
Dashed lines indicate optional steps. See the complete <a href="../examples/stationary/example_RDT_station/">example notebook</a>.</p>
<h4 id="roving-crnp-processing">Roving CRNP processing</h4>
<p><a class="glightbox" href="../img/workflow_hydroinnova.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="CRNPy Processing Workflow" src="../img/workflow_hydroinnova.png" /></a>
Dashed lines indicate optional steps. See the complete <a href="../examples/rover/Hydroinnova_rover_example/">example notebook</a>.</p>
<h3 id="incoming-neutron-flux">Incoming neutron flux</h3>
<p>The CRNPy library includes a complete set of methods for correcting the raw observed neutron counts for natural variation in the incoming neutron flux, including a set of tools for searching and downloading data from reference neutron monitors from the NMDB database (www.nmdb.eu) with similar the cut-off rigidity as the study location (Klein et al., 2009; Shea &amp; Smart., 2019).</p>
<table>
<thead>
<tr>
<th>Incoming neutron flux correction factor</th>
</tr>
</thead>
<tbody>
<tr>
<td>$fi = \frac{I_{m}}{I_{0}}$</td>
</tr>
<tr>
<td>$ fi $: Incoming neutron flux correction factor</td>
</tr>
<tr>
<td>$ I_{m} $: Measured incoming neutron flux</td>
</tr>
<tr>
<td>$ I_{0} $: Reference incoming neutron flux at a given time.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Implementation</p>
<p>See  <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.cutoff_rigidity">crnpy.crnpy.cutoff_rigidity</a>, <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.find_neutron_monitor">crnpy.crnpy.find_neutron_monitor</a>, <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.get_incoming_neutron_flux">crnpy.crnpy.get_incoming_neutron_flux</a>, <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.interpolate_incoming_flux">crnpy.crnpy.interpolate_incoming_flux</a> and [crnpy.crnpy.incoming_flux_correction][] documentation for the implementation details.</p>
</div>
<h3 id="atmospheric-corrections">Atmospheric corrections</h3>
<p>The CRNPy library also provides functions for correcting raw neutron counts for atmospheric pressure, air humidity, and air temperature (Andreasen et al., 2017; Rosolem et al., 2013).</p>
<table>
<thead>
<tr>
<th>Pressure correction</th>
<th>Atmospheric water correction</th>
</tr>
</thead>
<tbody>
<tr>
<td>$fp = exp(\frac{P_{0} - P}{L})$</td>
<td>$fw = 1 + 0.0054*(A - Aref)$</td>
</tr>
<tr>
<td>$fp$: Atmospheric pressure correction factor</td>
<td>$fw$: Atmospheric water correction factor</td>
</tr>
<tr>
<td>$P_{0}$: Reference atmospheric pressure (for e.g. long-term average)</td>
<td>$A$: Atmospheric absolute humidity (g/m3)</td>
</tr>
<tr>
<td>$P$: Measured atmospheric pressure</td>
<td>$Aref$: Reference atmospheric absolute humidity (g/m3)</td>
</tr>
<tr>
<td>$L$: Mass attenuation factor for high-energy neutrons in air</td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Implementation</p>
<p>See [crnpy.crnpy.humidity_correction][] and [crnpy.crnpy.pressure_correction][] documentation for the implementation details.</p>
</div>
<h3 id="biomass-correction">Biomass correction</h3>
<p>The library provides a function for correcting neutron counts for the effects of above-ground biomass by combining an approach for estimating biomass water equivalent (BWE) from in-situ biomass samples and the BWE correction factor (Baatz et al., 2015).</p>
<table>
<thead>
<tr>
<th>Biomass correction</th>
</tr>
</thead>
<tbody>
<tr>
<td>$fb = 1 - bwe*r2_N0$</td>
</tr>
<tr>
<td>$fb$: Biomass correction factor</td>
</tr>
<tr>
<td>$bwe$: Biomass water equivalent</td>
</tr>
<tr>
<td>$r2_N0$: Ratio of the neutron counts reduction ($counts kg^-1$) to the neutron calibration constant (N0)</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Implementation</p>
<p>See [crnpy.crnpy.bwe_correction][] and <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.biomass_to_bwe">crnpy.crnpy.biomass_to_bwe</a> documentation for the implementation details.</p>
</div>
<h3 id="road-correction">Road correction</h3>
<p>The lCRNPY library includes functions to correct for the effect of roads during rover surveys which account for the field soil water content and the road water content following the approach proposed by Schrön et al., (2018).</p>
<table>
<thead>
<tr>
<th>Road correction</th>
</tr>
</thead>
<tbody>
<tr>
<td>$fr = 1 + F1 \cdot F2 \cdot F3$</td>
</tr>
<tr>
<td>$fr$: Road correction factor</td>
</tr>
<tr>
<td>$F1$: Road geometry term</td>
</tr>
<tr>
<td>$F2$: Road moisture term</td>
</tr>
<tr>
<td>$F3$: Road distance term</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Implementation</p>
<p>See [crnpy.crnpy.road_correction][] documentation for the implementation details.</p>
</div>
<h3 id="additional-corrections">Additional corrections</h3>
<p>Other correction routines includes corrections for soil lattice water and total soil carbon that are known to affect the attentuation of epithermal cosmic-ray neutrons. A function to estimate the soil lattice water content based on clay content and soil organic carbon content was developed using soil samples collected across the state of Kansas.</p>
<div class="admonition info">
<p class="admonition-title">Implementation</p>
<p>See [crnpy.crnpy.estimate_lattice_water][] and <a class="autorefs autorefs-internal" href="../reference/#crnpy.crnpy.counts_to_vwc">crnpy.crnpy.counts_to_vwc</a> documentation for the implementation details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">References</p>
<p>Klein, K.-L., Steigies, C., &amp; Nmdb Team. (2009). WWW.NMDB.EU: The real-time Neutron Monitor database. EGU General Assembly Conference Abstracts, 5633.</p>
<p>Shea, M., &amp; Smart, D. (2019). Re-examination of the first five ground-level events. International Cosmic Ray Conference (ICRC2019), 36, 1149.</p>
<p>Smart, D., &amp; Shea, M. (2001). Geomagnetic cutoff rigidity computer program: Theory, software description and example.</p>
<p>Andreasen, M., Jensen, K. H., Desilets, D., Franz, T. E., Zreda, M., Bogena, H. R., &amp; Looms, M. C. (2017). Status and perspectives on the cosmic-ray neutron method for soil moisture estimation and other environmental science applications. Vadose Zone Journal, 16(8), 1–11.</p>
<p>Rosolem, R., Shuttleworth, W. J., Zreda, M., Franz, T. E., Zeng, X., &amp; Kurc, S. A. (2013). The effect of atmospheric water vapor on neutron count in the cosmic-ray soil moisture observing system. Journal of Hydrometeorology, 14(5), 1659–1671.</p>
<p>Zreda, M., Desilets, D., Ferré, T., &amp; Scott, R. L. (2008). Measuring soil moisture content non-invasively at intermediate spatial scale using cosmic-ray neutrons. Geophysical Research Letters, 35(21).</p>
<p>Dong, J., &amp; Ochsner, T. E. (2018). Soil texture often exerts a stronger influence than precipitation on mesoscale soil moisture patterns. Water Resources Research, 54(3), 2199–2211.</p>
<p>Wahbi, A., Heng, L., Dercon, G., Wahbi, A., &amp; Avery, W. (2018). In situ destructive sampling. Cosmic Ray Neutron Sensing: Estimation of Agricultural Crop Biomass Water Equivalent, 5–9.</p>
<p>Baatz, R., Bogena, H., Hendricks Franssen, H.-J., Huisman, J., Montzka, C., &amp; Vereecken, H. (2015). An empirical vegetation correction for soil water content quantification using cosmic ray probes. Water Resources Research, 51(4), 2030–2046.</p>
<p>Schrön, M., Rosolem, R., Köhli, M., Piussi, L., Schröter, I., Iwema, J., Kögler, S., Oswald, S. E., Wollschläger, U., Samaniego, L., &amp; others. (2018). Cosmic-ray neutron rover surveys of field soil moisture and the influence of roads. Water Resources Research, 54(9), 6441–6459.</p>
<p>Zreda, M., Shuttleworth, W. J., Zeng, X., Zweck, C., Desilets, D., Franz, T., and Rosolem, R.: COSMOS: the COsmic-ray Soil Moisture Observing System, Hydrol. Earth Syst. Sci., 16, 4079–4099, https://doi.org/10.5194/hess-16-4079-2012, 2012.</p>
</div>







  
  






                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>